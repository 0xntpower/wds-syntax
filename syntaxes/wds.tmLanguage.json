{
    "scopeName": "source.wds",
    "name": "WDS",
    "patterns": [
        { "include": "#comments" },
        { "include": "#expression-evaluators" },
        { "include": "#dot-commands" },
        { "include": "#extension-commands" },
        { "include": "#debugger-commands" },
        { "include": "#pseudo-registers" },
        { "include": "#registers" },
        { "include": "#strings" },
        { "include": "#numbers" },
        { "include": "#operators" },
        { "include": "#keywords" }
    ],
    "repository": {
        "comments": {
            "patterns": [
                {
                    "name": "comment.line.dollar-dollar.wds",
                    "begin": "\\$\\$",
                    "end": "$"
                },
                {
                    "name": "comment.line.asterisk.wds",
                    "match": "^\\s*\\*.*$"
                },
                {
                    "name": "comment.block.wds",
                    "begin": "\\$\\*",
                    "end": "\\*\\$"
                }
            ]
        },
        "dot-commands": {
            "patterns": [
                {
                    "name": "keyword.control.wds",
                    "match": "(?<=^|\\s)\\.(block|for|if|else|elsif|foreach|while|do|break|continue|catch|leave)(?=\\s|\\(|\\{|$)"
                },
                {
                    "name": "support.function.output.wds",
                    "match": "\\.(printf|echo|echot|echotcpip|formats)\\b"
                },
                {
                    "name": "support.function.logging.wds",
                    "match": "\\.(logopen|logclose|logappend)\\b"
                },
                {
                    "name": "support.function.symbol.wds",
                    "match": "\\.(sympath|symfix|symopt|reload|srcpath|lsrcpath|srcnoisy)\\b"
                },
                {
                    "name": "support.function.session.wds",
                    "match": "\\.(detach|kill|restart|quit|attach|abandon|create|opendump|writedump)\\b"
                },
                {
                    "name": "support.function.context.wds",
                    "match": "\\.(frame|cxr|exr|trap|thread|process)\\b"
                },
                {
                    "name": "support.function.expression.wds",
                    "match": "\\.(expr|enable_unicode|enable_long_status|prefer_dml)\\b"
                },
                {
                    "name": "support.function.display.wds",
                    "match": "\\.(cls|time|lastevent|eventlog)\\b"
                },
                {
                    "name": "support.function.remote.wds",
                    "match": "\\.(remote|server|endsrv|clients)\\b"
                },
                {
                    "name": "support.function.script.wds",
                    "match": "\\$\\$?[><a-z]*"
                }
            ]
        },
        "extension-commands": {
            "patterns": [
                {
                    "name": "support.function.extension.analysis.wds",
                    "match": "\\!(analyze|exploitable|msec[_a-z]*)\\b"
                },
                {
                    "name": "support.function.extension.memory.wds",
                    "match": "\\!(address|vprot|pool|poolfind|heap|gflag)\\b"
                },
                {
                    "name": "support.function.extension.iteration.wds",
                    "match": "\\!(for_each_module|for_each_frame|for_each_register|for_each_local)\\b"
                },
                {
                    "name": "support.function.extension.process.wds",
                    "match": "\\!(peb|teb|gle|error|handle|token|sid)\\b"
                },
                {
                    "name": "support.function.extension.kernel.wds",
                    "match": "\\!(pcr|prcb|idt|gdt|irql|irpfind|devobj|drvobj|devnode|devstack)\\b"
                },
                {
                    "name": "support.function.extension.debug.wds",
                    "match": "\\!(exchain|sxe|cppexr|avrf|verifier)\\b"
                },
                {
                    "name": "support.function.extension.module.wds",
                    "match": "\\!(lmi|dlls|dh|imgreloc|chkimg)\\b"
                },
                {
                    "name": "support.function.extension.stack.wds",
                    "match": "\\!(uniqstack|stacks|findstack)\\b"
                },
                {
                    "name": "support.function.extension.thread.wds",
                    "match": "\\!(thread|tls|runaway|locks)\\b"
                },
                {
                    "name": "support.function.extension.sym.wds",
                    "match": "\\!(sym|symnoisy|chksym|itoldyouso)\\b"
                },
                {
                    "name": "support.function.extension.dx.wds",
                    "match": "\\bdx\\b"
                },
                {
                    "name": "support.function.extension.py.wds",
                    "match": "\\!(py|pykd)\\b"
                }
            ]
        },
        "debugger-commands": {
            "patterns": [
                {
                    "name": "keyword.control.execution.wds",
                    "match": "\\b(g[hnu]?|t[ahp]?|p[achrt]?|wt|gu)\\b"
                },
                {
                    "name": "support.function.breakpoint.wds",
                    "match": "\\b(bp|ba|bu|bm|bd|be|bc|bl|br)\\b"
                },
                {
                    "name": "support.function.exception.wds",
                    "match": "\\b(sx[erd]?|sxn)\\b"
                },
                {
                    "name": "support.function.display.data.wds",
                    "match": "\\b(d[aAbBcCdDfFpPqQsSwWuUyY]?)\\b"
                },
                {
                    "name": "support.function.display.pointer.wds",
                    "match": "\\bdps\\b"
                },
                {
                    "name": "support.function.edit.wds",
                    "match": "\\b(e[aAbBdDfFpPqQwW]?)\\b"
                },
                {
                    "name": "support.function.search.wds",
                    "match": "\\b(s(-\\[[0-9lL]\\])?[aAbBdDqQsSwWuU]?)\\b"
                },
                {
                    "name": "support.function.stack.wds",
                    "match": "\\bk[bBcCdDfFnNpPvVL]*\\b"
                },
                {
                    "name": "support.function.module.wds",
                    "match": "\\blm[aDfklouvVmDsSeE]*\\b"
                },
                {
                    "name": "support.function.unassemble.wds",
                    "match": "\\b(u[bfrs]?|uf)\\b"
                },
                {
                    "name": "support.function.register.wds",
                    "match": "\\b(r[mMfFxX]?)\\b"
                },
                {
                    "name": "support.function.type.wds",
                    "match": "\\b(dt|dv)\\b"
                },
                {
                    "name": "support.function.symbol.wds",
                    "match": "\\b(x|ln|ls[af]?)\\b"
                },
                {
                    "name": "support.function.version.wds",
                    "match": "\\b(vertarget|version|vercommand)\\b"
                },
                {
                    "name": "keyword.operator.process.wds",
                    "match": "~[sS]?"
                },
                {
                    "name": "keyword.operator.system.wds",
                    "match": "\\|[sS]?"
                },
                {
                    "name": "keyword.operator.evaluate.wds",
                    "match": "\\?"
                }
            ]
        },
        "expression-evaluators": {
            "patterns": [
                {
                    "name": "meta.expression.cpp.wds",
                    "begin": "@@C\\+\\+\\(",
                    "end": "\\)",
                    "beginCaptures": {
                        "0": { "name": "keyword.operator.expression.cpp.wds" }
                    },
                    "endCaptures": {
                        "0": { "name": "keyword.operator.expression.cpp.wds" }
                    },
                    "patterns": [
                        { "include": "#pseudo-registers" },
                        { "include": "#registers" },
                        { "include": "#numbers" },
                        { "include": "#operators" }
                    ]
                },
                {
                    "name": "meta.expression.masm.wds",
                    "begin": "@@masm\\(",
                    "end": "\\)",
                    "beginCaptures": {
                        "0": { "name": "keyword.operator.expression.masm.wds" }
                    },
                    "endCaptures": {
                        "0": { "name": "keyword.operator.expression.masm.wds" }
                    },
                    "patterns": [
                        { "include": "#pseudo-registers" },
                        { "include": "#registers" },
                        { "include": "#numbers" },
                        { "include": "#operators" }
                    ]
                },
                {
                    "name": "meta.expression.default.wds",
                    "begin": "@@\\(",
                    "end": "\\)",
                    "beginCaptures": {
                        "0": { "name": "keyword.operator.expression.wds" }
                    },
                    "endCaptures": {
                        "0": { "name": "keyword.operator.expression.wds" }
                    },
                    "patterns": [
                        { "include": "#pseudo-registers" },
                        { "include": "#registers" },
                        { "include": "#numbers" },
                        { "include": "#operators" }
                    ]
                }
            ]
        },
        "pseudo-registers": {
            "patterns": [
                {
                    "name": "variable.other.pseudo-register.temp.wds",
                    "match": "\\$t([0-9]|1[0-9])\\b"
                },
                {
                    "name": "variable.parameter.pseudo-register.arg.wds",
                    "match": "\\$arg[1-9][0-9]*\\b"
                },
                {
                    "name": "variable.other.pseudo-register.special.wds",
                    "match": "\\$(ip|ra|retreg|exentry|scopeip|bp|bpnum)\\b"
                },
                {
                    "name": "variable.other.pseudo-register.context.wds",
                    "match": "\\$(peb|teb|csp|cip|tpid|tid|thread|proc)\\b"
                },
                {
                    "name": "variable.other.pseudo-register.event.wds",
                    "match": "\\$(ea|ea2|exp|evt|exr|cxr|lastclrex)\\b"
                },
                {
                    "name": "variable.other.pseudo-register.frame.wds",
                    "match": "\\$(frame|dbgtime|callret|ptrsize|pagesize)\\b"
                },
                {
                    "name": "variable.other.pseudo-register.module.wds",
                    "match": "@#(Base|End|Size|ModuleName|ImageName|LoadedImageName|MappedImageName)\\b"
                }
            ]
        },
        "registers": {
            "patterns": [
                {
                    "name": "variable.language.register.x64.wds",
                    "match": "\\b(rax|rbx|rcx|rdx|rsi|rdi|rbp|rsp|rip)\\b"
                },
                {
                    "name": "variable.language.register.x64.extended.wds",
                    "match": "\\b(r8|r9|r10|r11|r12|r13|r14|r15)\\b"
                },
                {
                    "name": "variable.language.register.x86.wds",
                    "match": "\\b(eax|ebx|ecx|edx|esi|edi|ebp|esp|eip)\\b"
                },
                {
                    "name": "variable.language.register.x86-16.wds",
                    "match": "\\b(ax|bx|cx|dx|si|di|bp|sp|ip)\\b"
                },
                {
                    "name": "variable.language.register.x86-8.wds",
                    "match": "\\b(al|ah|bl|bh|cl|ch|dl|dh|sil|dil|bpl|spl)\\b"
                },
                {
                    "name": "variable.language.register.x64-32.wds",
                    "match": "\\b(r[89]d|r1[0-5]d)\\b"
                },
                {
                    "name": "variable.language.register.x64-16.wds",
                    "match": "\\b(r[89]w|r1[0-5]w)\\b"
                },
                {
                    "name": "variable.language.register.x64-8.wds",
                    "match": "\\b(r[89]b|r1[0-5]b)\\b"
                },
                {
                    "name": "variable.language.register.segment.wds",
                    "match": "\\b(cs|ds|es|fs|gs|ss)\\b"
                },
                {
                    "name": "variable.language.register.flags.wds",
                    "match": "\\b(efl|rfl|flags)\\b"
                },
                {
                    "name": "variable.language.register.xmm.wds",
                    "match": "\\b(xmm([0-9]|1[0-5]))\\b"
                },
                {
                    "name": "variable.language.register.ymm.wds",
                    "match": "\\b(ymm([0-9]|1[0-5]))\\b"
                },
                {
                    "name": "variable.language.register.zmm.wds",
                    "match": "\\b(zmm([0-9]|[12][0-9]|3[01]))\\b"
                },
                {
                    "name": "variable.language.register.fpu.wds",
                    "match": "\\b(st[0-7])\\b"
                },
                {
                    "name": "variable.language.register.mmx.wds",
                    "match": "\\b(mm[0-7])\\b"
                },
                {
                    "name": "variable.language.register.debug.wds",
                    "match": "\\b(dr[0-7])\\b"
                },
                {
                    "name": "variable.language.register.control.wds",
                    "match": "\\b(cr[0-48])\\b"
                }
            ]
        },
        "strings": {
            "patterns": [
                {
                    "name": "string.quoted.double.wds",
                    "begin": "\"",
                    "end": "\"",
                    "patterns": [
                        {
                            "name": "constant.character.escape.wds",
                            "match": "\\\\."
                        }
                    ]
                },
                {
                    "name": "string.quoted.single.wds",
                    "begin": "'",
                    "end": "'",
                    "patterns": [
                        {
                            "name": "constant.character.escape.wds",
                            "match": "\\\\."
                        }
                    ]
                }
            ]
        },
        "numbers": {
            "patterns": [
                {
                    "name": "constant.numeric.hex.wds",
                    "match": "\\b0[xX][0-9a-fA-F]+\\b"
                },
                {
                    "name": "constant.numeric.hex.backtick.wds",
                    "match": "`[0-9a-fA-F]+`?"
                },
                {
                    "name": "constant.numeric.binary.wds",
                    "match": "\\b0[yY][01]+\\b"
                },
                {
                    "name": "constant.numeric.octal.wds",
                    "match": "\\b0[nNoO][0-7]+\\b"
                },
                {
                    "name": "constant.numeric.decimal.wds",
                    "match": "\\b([0-9]+\\.)?[0-9]+(n|L)?\\b"
                }
            ]
        },
        "operators": {
            "patterns": [
                {
                    "name": "keyword.operator.comparison.wds",
                    "match": "(==|!=|<=|>=|<[^<]|>[^>])"
                },
                {
                    "name": "keyword.operator.logical.wds",
                    "match": "(&&|\\|\\||!(?!=))"
                },
                {
                    "name": "keyword.operator.arithmetic.wds",
                    "match": "(\\+|-|\\*|/|%)"
                },
                {
                    "name": "keyword.operator.bitwise.wds",
                    "match": "(<<|>>|&(?!&)|\\|(?!\\|)|\\^|~)"
                },
                {
                    "name": "keyword.operator.dereference.wds",
                    "match": "\\b(poi|wo|dwo|qwo|by|hi|low)\\b"
                },
                {
                    "name": "keyword.operator.at.wds",
                    "match": "@(?!@)"
                }
            ]
        },
        "keywords": {
            "patterns": [
                {
                    "name": "keyword.operator.logical.word.wds",
                    "match": "\\b(not|and|or|xor|mod)\\b"
                },
                {
                    "name": "constant.language.wds",
                    "match": "\\b(TRUE|FALSE|NULL)\\b"
                }
            ]
        }
    }
}
